## SELECTIVE-REPEAT 프로토콜
- 시뮬레이션 링크 : https://media.pearsoncmg.com/aw/ecs_kurose_compnetwork_7/cw/content/interactiveanimations/selective-repeat-protocol/index.html
### 송신측
- window 크기 내의 패킷을 수신측으로 전송한다. (전송시 시퀀스 번호는 순차적이다.)
- ACK를 순차적으로 받으며 윈도우를 이동시키는데, 순차적이지 않을 경우 윈도우를 고정시킨다. 순차적이지 않는 ACK에 대해서는 수신측이 받은 것으로 처리된다.
- time out이 되면 window내의 ACK를 받지 못한 패킷을 재전송한다.

### 수신측
- 송신측으로부터 패킷을 받아 ACK를 전송한다.
- 패킷을 순차적으로 받으면 버퍼를 이동시킨다.
- 순차적이지 않다면 버퍼를 고정시킨다.

### 정리
- 윈도우, 버퍼는 가장 왼쪽(순차적)인 것을 기준으로 이동한다.
- 순차적으로 이동하며, n번째의 ACK 또는 패킷이 오지 않는 경우 window를 n번째로 고정시키고 움직이지 않는다.
- 일정시간이 지난 후에는 처리가 되지 않은 window 내의 패킷을 재전송한다.

## 시나리오
### 1. 정상적인 전달
<img src="./img/정상적인 전달_S.gif">

- 송신측에서 정해진 크기의 window 내에서 패킷을 전송한다.
- 수신측에서 패킷을 받아 ACK를 송신측으로 전달한다. (버퍼 이동)
- 송신측에서 ACK를 순차적으로 받으며 window를 이동시킨다.

<br>

### 2. 전송 중 첫번째 패킷의 손실
<img src="./img/전송 중 첫번째 패킷의 손실_S.gif">

- 송신측에서 정해진 크기의 window 내에서 패킷을 전송한다.
- 전송 중 첫번째 패킷의 손실이 난다.
- 수신측에서는 첫번째 패킷이 도착하지 않았으므로 첫번째에 버퍼를 고정시키고, 이후의 패킷을 버퍼에 저장 + ACK를 전송한다.
- 송신측에서 ACK를 받은 뒤 time out이 되면 ACK가 도착하지 않은 패킷만 재전송한다.

<br>

### 3. 전송 중 마지막 패킷의 손실
<img src="./img/전송 중 마지막 패킷의 손실_S.gif">

- 송신측에서 정해진 크기의 window 내에서 패킷을 전송한다.
- 전송 중 마지막 패킷의 손실이 난다.
- 수신측에서는 패킷을 받으며 버퍼를 이동시킨다. 그리고 ACK를 보낸다. 그러나 마지막 패킷이 도착하지 않았기에 마지막 패킷의 자리에 버퍼가 위치한다.
- 송신측에서 ACK를 받으며 window를 이동시킨다. 마지막 패킷의 ACK가 도착하지 않았으므로, time out이 되면 마지막 패킷만 재전송한다.

<br>

### 4. 전송 중 중간 패킷의 손실
<img src="./img/전송 중 중간 패킷의 손실_S.gif">

- 2, 3번의 합작
- 송신측에서 정해진 크기의 window 내에서 패킷을 전송한다.
- 수신측에서 패킷을 순차적으로 받는데, 안 온 패킷의 시퀀스넘버에 버퍼가 위치한다. 이후의 패킷은 버퍼에 저장한다. (패킷에 대해 ACK를 전송한다)
- 송신측에서 ACK를 받으며 window를 이동시킨다. 수신측과 동일하게 안 온 ACK의 넘버에 window가 위치한다.
- time out이 되면 ACK를 받지 못한 패킷만 재전송한다.

<br>

### 5. 수신측의 첫번째 ACK 손실
<img src="./img/수신측의 첫번째 ACK 손실_S.gif">

- 송신측에서 정해진 크기의 window 내에서 패킷을 전송한다.
- 수신측에서 패킷을 받으며, ACK를 전송한다.
- 첫번째 ACK의 손실이 난다.
- 송신측에서 ACK를 받는데, 첫번째 ACK가 오지 않았으므로, window를 이동시키지 않는다.
- time out이 되면 첫번째 패킷만 재전송한다.

<br>

### 6. 수신측의 마지막 ACK 손실
<img src="./img/수신측의 마지막 ACK 손실_S.gif">
- 송신측에서 정해진 크기의 window 내에서 패킷을 전송한다.
- 수신측에서 패킷을 받으며 ACK를 전송한다.
- 마지막 ACK의 손실이 난다.
- 송신측에서 ACK를 받으며 window를 이동시키는데, 마지막 ACK가 도착하지 않았으므로, 마지막 패킷의 자리에 window가 위치한다.
- time out이 되면 마지막 패킷을 재전송한다.

<br>

### 7. 수신측의 중간 ACK 손실
<img src="./img/수신측의 중간 ACK 손실_S.gif">

- 6, 7번의 합작
- 송신측에서 정해진 크기의 window 내에서 패킷을 전송한다.
- 수신측에서 패킷을 받으며 ACK를 전송한다.
- 중간 패킷에 대한 ACK의 손실이 난다.
- 송신측에서 ACK를 받으며 window를 이동시키는데, 중간 패킷에 대한 ACK가 오지 않았으므로 window는 중간 패킷의 자리에 위치한다.
- time out이 되면 중간 패킷을 재전송한다.
